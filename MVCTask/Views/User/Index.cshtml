@model MVCTask.ViewModels.UserViewModel
@{
    ViewBag.Title = "Index";
}

<a href="/user/Create" class="btn btn-success">Add User</a>

<table class="table table-hover">
   <thead>
      <tr>
         <th scope="col">user_id</th>
         <th scope="col">user_name</th>
         <th scope="col">dept_name</th>
         <th scope="col">action</th>
      </tr>
   </thead>
   <tbody>
      @foreach (var user in Model.userList) {
         <tr>
            <th>@user.user_id</th>
            <td>@user.user_name</td>
            <td>@user.dept.dept_name</td>
            <td>
               <a class="btn btn-warning" href="/user/Edit/@user.user_id">Edit</a>
               <button class="btn btn-danger" onclick="DeleteUser(@user.user_id)">Delete</button>
            </td>
         </tr>
      }
   </tbody>
</table>

<script>
   function DeleteUser(id)
   {
      var checkDelete = confirm("Are you sure about to delete the user?");
      
      if (checkDelete) {
         $.ajax({
            url: "/user/Delete",
            data: {
               userid:id
            },
            success: function (result) {
               window.location("/user/Index");
            }
         });
      }
   }
</script>
